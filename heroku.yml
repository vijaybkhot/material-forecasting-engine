# heroku.yml
setup:
  addons:
    - plan: heroku-postgresql
      as: DATABASE

build:
  docker:
    web: Dockerfile

release:
  command:
    - sh -c "export PYTHONPATH=/app && export GIT_SHA=$(git rev-parse HEAD) && alembic upgrade head && python ml/scripts/ingest_data.py && python ml/scripts/train_all_models.py"
  image: web

run:
  web: uvicorn app.main:app --host 0.0.0.0 --port $PORT
